local Lighting = game:GetService("Lighting")
local RunService = game:GetService("RunService")
local Players = game:GetService("Players")
local StarterGui = game:GetService("StarterGui")

-- Giảm 60% đồ họa
Lighting.GlobalShadows = false -- Tắt bóng toàn cục
Lighting.Brightness = 0.7 -- Giảm độ sáng (giảm 30%)
Lighting.ShadowSoftness = 0
Lighting.EnvironmentDiffuseScale = 0.4 -- Giảm ánh sáng khuếch tán (giảm 60%)
Lighting.EnvironmentSpecularScale = 0.4 -- Giảm ánh sáng phản chiếu (giảm 60%)

-- Đặt chất lượng đồ họa ở mức trung bình thấp (khoảng 40% so với max)
settings().Rendering.QualityLevel = Enum.QualityLevel.Level05

-- Xóa 60% hiệu ứng chiêu thức (xác suất 60%)
for _, v in pairs(game:GetDescendants()) do
    local shouldDisable = math.random() <= 0.6 -- Xác suất 60%
    if shouldDisable then
        if v:IsA("ParticleEmitter") or v:IsA("Trail") then
            v.Enabled = false -- Tắt hiệu ứng hạt và vệt của chiêu thức
        elseif v:IsA("BasePart") then
            v.CastShadow = false -- Tắt bóng của các đối tượng
        elseif v:IsA("PointLight") or v:IsA("SurfaceLight") then
            v.Enabled = false -- Tắt ánh sáng động từ chiêu thức
        end
    end
end

-- Vòng lặp để đảm bảo các hiệu ứng chiêu thức mới có xác suất 60% bị xóa
RunService.Heartbeat:Connect(function()
    for _, v in pairs(game:GetDescendants()) do
        local shouldDisable = math.random() <= 0.6 -- Xác suất 60%
        if shouldDisable then
            if v:IsA("ParticleEmitter") or v:IsA("Trail") then
                v.Enabled = false
            elseif v:IsA("BasePart") then
                v.CastShadow = false
            elseif v:IsA("PointLight") or v:IsA("SurfaceLight") then
                v.Enabled = false
            end
        end
    end
end)

-- Tạo giao diện hiển thị FPS
local player = Players.LocalPlayer
local screenGui = Instance.new("ScreenGui")
screenGui.Parent = player:WaitForChild("PlayerGui")
screenGui.Name = "FPSDisplay"

local frame = Instance.new("Frame")
frame.Size = UDim2.new(0, 100, 0, 30)
frame.Position = UDim2.new(0, 10, 0, 10)
frame.BackgroundTransparency = 0.5
frame.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
frame.Parent = screenGui

local fpsLabel = Instance.new("TextLabel")
fpsLabel.Size = UDim2.new(1, 0, 1, 0)
fpsLabel.BackgroundTransparency = 1
fpsLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
fpsLabel.Text = "FPS: 0"
fpsLabel.Parent = frame

-- Tính và cập nhật FPS
local lastTime = tick()
local frameCount = 0

-- Bảng màu cầu vồng (RGB)
local rainbowColors = {
    Color3.fromRGB(255, 0, 0),   -- Đỏ
    Color3.fromRGB(255, 127, 0), -- Cam
    Color3.fromRGB(255, 255, 0), -- Vàng
    Color3.fromRGB(0, 255, 0),   -- Xanh lá
    Color3.fromRGB(0, 0, 255),   -- Xanh dương
    Color3.fromRGB(75, 0, 130),  -- Chàm
    Color3.fromRGB(148, 0, 211)  -- Tím
}
local colorIndex = 1

RunService.RenderStepped:Connect(function()
    -- Cập nhật FPS
    frameCount = frameCount + 1
    local currentTime = tick()
    if currentTime - lastTime >= 1 then
        local fps = math.floor(frameCount / (currentTime - lastTime))
        fpsLabel.Text = "FPS: " .. fps
        frameCount = 0
        lastTime = currentTime
    end

    -- Thay đổi màu cầu vồng
    fpsLabel.TextColor3 = rainbowColors[colorIndex]
    colorIndex = colorIndex + 1
    if colorIndex > #rainbowColors then
        colorIndex = 1 -- Lặp lại từ đầu
    end
end)

-- Thông báo script đã chạy
StarterGui:SetCore("SendNotification", {
    Title = "Fix Lag Script",
    Text = "Reduced graphics by 60%, removed 60% skill effects, and enabled rainbow FPS counter.",
    Duration = 5
})
